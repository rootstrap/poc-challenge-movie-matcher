package com.swmansion.rnscreens

import android.app.Activity
import android.os.Bundle
import android.view.LayoutInflater
import androidx.recyclerview.widget.LinearLayoutManager
import com.bumptech.glide.Glide
import com.bumptech.glide.load.engine.DiskCacheStrategy
import com.bumptech.glide.load.resource.drawable.DrawableTransitionOptions
import com.google.android.material.snackbar.Snackbar
import com.swmansion.rnscreens.databinding.ActivityMovieDetailBinding

class MovieDetailActivity : Activity() {

    private val fakeList = listOf(
        RecommendedBy(name = "Juan Perez", imageUrl = "", isFriend = false),
        RecommendedBy(name = "Maria Fernandez", imageUrl = "", isFriend = false),
        RecommendedBy(name = "Martín Baez", imageUrl = "", isFriend = false),
        RecommendedBy(name = "Lucía Martinez", imageUrl = "", isFriend = false),
    )

    private lateinit var binding: ActivityMovieDetailBinding

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        binding = ActivityMovieDetailBinding.inflate(LayoutInflater.from(this))
        setContentView(binding.root)
        initView()
    }

    private fun initView(){
        binding.backBtn.setOnClickListener {
            finish()
        }

        binding.recommendBtn.setOnClickListener {
            Snackbar.make(binding.root, "Added to your recommendations", Snackbar.LENGTH_LONG).show()
            binding.recommendBtn.text = getString(R.string.remove_recommendation)
        }

        binding.addToListBtn.setOnClickListener {
            Snackbar.make(binding.root, "Added to your watch list", Snackbar.LENGTH_LONG).show()
            binding.addToListBtn.text = getString(R.string.remove_my_list)
        }

        Glide.with(applicationContext)
            .load("https://image.tmdb.org/t/p/original//sv1xJUazXeYqALzczSZ3O6nkH75.jpg")
            .transition(DrawableTransitionOptions.withCrossFade().transition(android.R.anim.fade_in))
            .diskCacheStrategy(DiskCacheStrategy.ALL)
            .centerCrop()
            .into(binding.movieImage)
        setRecommendedByList()
    }

    private fun setRecommendedByList() {
        with(binding.recycler) {
            layoutManager = LinearLayoutManager(
                this@MovieDetailActivity,
                LinearLayoutManager.HORIZONTAL,
                false
            )
            adapter = RecommendedByAdapter(fakeList).also {
                it.notifyDataSetChanged()
            }
        }
    }
}